<!DOCTYPE html>

<!----------------------------------------------
  customer evaluation and its background
-->
<div id="background">

  <div class="evaluation">
    <p> 顧客評價 </p>
    <p> -/5 </p>
    <!--The star for evaluation-->
    <div class="star_form"> 
        <img src="/img/feedback/gray_star.png"> 
        <img src="/img/feedback/gray_star.png"> 
        <img src="/img/feedback/gray_star.png"> 
        <img src="/img/feedback/gray_star.png"> 
        <img src="/img/feedback/gray_star.png"> 
    </div>
  </div>

</div>
<!--The area of comments-->
<div class="ui comments">
  <!--each comment-->
  {{#each comment}}
  <div class="comment">

    <div class="star">
      {{star}}
      <img src="/img/feedback/level_star.png">
    </div>
    <!--the photo-->
    <div class="avatar">
      <img src="/img/feedback/photo.png">
    </div>
    
    <div class="content">
      <a class="author"> {{author}} </a>
      <div class="metadata">
        <div class="date">{{time}}</div>
      </div>
      <div class="text">
        {{message}}
      </div>

    </div>
  </div> 
  <!--The line for seperating.-->
  <img src="/img/feedback/line.jpg" class="line">
  {{/each}}

</div>
<link rel="stylesheet" type="text/css" href="/css/feedback.css">
<script>
  $(document).ready(function(){
    var star_total = 0;
    var star_avg = 0;
    var size = $('.comment').size();
    
    for(i = 0; i<=size-1; i++){
      var temp = $('.comment .star').eq(i).text();
      star_total = star_total + parseInt(temp);
    }
    console.log(star_total);
    
    star_avg = formatFloat(star_total/size,1);
    console.log(star_avg);
    for( i =0; i <= Math.floor(star_avg)-1; i++){
      $('.star_form img').eq(i).attr("src","/img/feedback/white_star.png");
    }
    if( star_avg - Math.floor(star_avg) >=0.5){
      $('.star_form img').eq(Math.floor(star_avg)).attr("src","/img/feedback/half_star.png");
      $('.evaluation p:nth-child(2)').text((star_avg)+'/5');
    }
    
  });
function formatFloat(num, pos)
{
  var size = Math.pow(10, pos);
    return Math.round(num * size) / size;
}
</script>



